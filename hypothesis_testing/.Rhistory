source("http://bioconductor.org/biocLite.R")
biocLite('phyloseq')
# install bioconductor package
#source("http://bioconductor.org/biocLite.R")
#biocLite('phyloseq')
# load package
library(phyloseq)
# install ggplot2
#install.packages("ggplot2")
# load package
library(ggplot2)
#### data import ####
# import biom (otu table and tax table)
biom <- import_biom("final.opti_mcc.0.03.biom")
View(biom)
biom
# install bioconductor package
#source("http://bioconductor.org/biocLite.R")
#biocLite('phyloseq')
# load package
library(phyloseq)
# install ggplot2
#install.packages("ggplot2")
# load package
library(ggplot2)
#### data import ####
# import biom (otu table and tax table)
biom <- import_biom("final.opti_mcc.0.03.biom")
biom
otu_table(biom)
# import map (metadata) file
map <- import_qiime_sample_data("../metadata_mapping_file.txt")
str(map)
# combine otu/tax and map
comb <- merge_phyloseq(biom, map) #, rep_tre)
str(comb)
comb
#### inspect combined otu/taxonomy/map data ####
## samples
# show sample names
sample_names(comb)
# count number of samples
nsamples(comb)
# show variables (metadata) for samples
sample_variables(comb)
## taxa
# show unique phyla in dataset
get_taxa_unique(comb, "Phylum")
# show total counts for each taxon in dataset
taxa_sums(comb)
# show only top 10 most frequent taxa
taxa_sums(comb)[1:10]
# examine total counts for each sample
sample_sums(comb)
comb
tax_table(comb)
import_biom
?import_biom
#### data import ####
# import biom (otu table and tax table)
biom <- import_biom("final.opti_mcc.0.03.biom", parseFunction = parse_taxonomy_greengenes)
rank_names(biom)
tax_table(biom)
# the code below corrects this issue with taxonomic ranks
# view names
rank_names(biom)
# correct taxonomy
tax_table(biom) <- tax_table(biom)[, 1:6]
rank_names(biom)
biom
#### inspect combined otu/taxonomy/map data ####
## samples
# show sample names
sample_names(comb)
# show total counts for each taxon in dataset
taxa_sums(comb)
# show only top 10 most frequent taxa
taxa_sums(comb)[1:10]
tax_table(biom)
# correct taxonomy
tax_table(biom) <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species")
rank_names(biom)
# the code below corrects this issue with taxonomic ranks
# view names
rank_names(biom)
#### data import ####
# import biom (otu table and tax table)
biom <- import_biom("final.opti_mcc.0.03.biom", parseFunction = parse_taxonomy_greengenes)
warnings()
#### data import ####
# import biom (otu table and tax table)
biom <- import_biom("final.opti_mcc.0.03.biom")
# the code below corrects this issue with taxonomic ranks
# view names
rank_names(biom)
# correct taxonomy
ranks <- <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species")
# correct taxonomy
ranks <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species")
tax_table(biom)
rank_names(biom)
rank_names(biom) <- ranks
rank_names(biom)
tax_table(biom) <- ranks
rank_names(biom)
ranka
ranks
#### data import ####
# import biom (otu table and tax table)
biom <- import_biom("final.opti_mcc.0.03.biom")
test <- biom
# the code below corrects this issue with taxonomic ranks
# view names
rank_names(test)
# correct taxonomy
ranks <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species")
tax_table(biom)
rank_names(biom)
# correct taxonomy
ranks <-
colnames(tax_table(test)) <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species")
colnames(tax_table(test))
# correct taxonomy
colnames(tax_table(test)) <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus")
rank_names(biom)
rank_names(test)
# the code below corrects this issue with taxonomic ranks
# view names
rank_names(biom)
# correct taxonomy
colnames(tax_table(biom)) <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus")
rank_names(biom)
